var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{p as a}from"./phaser-3q6lwrpP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class s extends a.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}const i=class e{static getLayer1(){return e.layer1}static getCameraScores(){return e.cameraScores}};t(i,"screen",{width:256,height:240,TILE_X:16,TILE_Y:16}),t(i,"layer1",{scaleX:2,scaleY:2,top:0,left:0}),t(i,"MARIO",{VEL_SCROLL:0,MAX_VEL_SCROLL:280,VEL_SALTO:445,MAX_VEL_SALTO:500,ACELERACION:7,DECELERACION:14}),t(i,"gameOver",!1),t(i,"marcadores",{puntos:0,nivel:1,hi:5e3}),t(i,"cameraScores",{x:0,y:0,ancho:256,alto:32,scrollX:0,scrollY:-32});let r=i;function o(e,t,a){e.volume=a,e.loop=t,e.play()}class l{constructor(e){this.relatedScene=e}create(){this.mario=this.relatedScene.physics.add.sprite(this.relatedScene.sys.game.config.width/2,100,"mario-ss1"),this.mario.setScale(r.getLayer1().scaleX,r.getLayer1().scaleY),this.mario.setSize(Phaser.Math.RoundTo(this.mario.width/1.4,0,10),this.mario.body.height),this.mario.setVisible(!0),this.mario.setFrame(0),this.mario.setFlipX(!1),this.mario.setCollideWorldBounds(!0),this.mario.body.setAllowGravity(!0),this.mario.setMaxVelocity(r.MARIO.MAX_VEL_SCROLL,r.MARIO.MAX_VEL_SALTO),this.mario.setData("acelera",r.MARIO.VEL_SCROLL),this.mario.setData("allow-salto",0),this.mario.setData("cadencia-salto",99),this.animaciones_mario(),this.joyStick=this.relatedScene.plugins.get("rexvirtualjoystickplugin").add(this.relatedScene,{x:128,y:this.relatedScene.sys.game.config.height-96,radius:50,base:this.relatedScene.add.circle(0,0,64,8947848,.6),thumb:this.relatedScene.add.circle(0,0,28,13421772),dir:"8dir",fixed:!0,enable:!0}),this.controlJoy=this.joyStick.createCursorKeys(),this.controles_mario=this.relatedScene.input.keyboard.createCursorKeys(),console.log(this.mario)}update(){this.salto(),this.direccion(),this.checkFallOutBounds(470)}salto(){(this.controles_mario.space.isDown||this.controlJoy.up.isDown)&&0===this.mario.body.velocity.y&&this.relatedScene.time.now>this.mario.getData("allow-salto")&&(this.mario.setVelocityY(-(r.MARIO.VEL_SALTO+Math.abs(.24*this.mario.getData("acelera")))),this.mario.setData("allow-salto",this.relatedScene.time.now+this.mario.getData("cadencia-salto")),o(this.relatedScene.sonido_jumpbros,!1,.3))}direccion(){this.controles_mario.left.isDown||this.controlJoy.left.isDown?(this.gestionar_aceleracion(!1),this.mario.setVelocityX(this.mario.getData("acelera")),this.mario.anims.play("mario-andar",!0),this.mario.setFlipX(!0)):this.controles_mario.right.isDown||this.controlJoy.right.isDown?(this.gestionar_aceleracion(!0),this.mario.setVelocityX(this.mario.getData("acelera")),this.mario.anims.play("mario-andar",!0),this.mario.setFlipX(!1)):this.mario.getData("acelera")!==r.MARIO.VEL_SCROLL?(this.mario.getData("acelera")>0?(this.mario.setData("acelera",this.mario.getData("acelera")-r.MARIO.DECELERACION),this.mario.setData("acelera",this.mario.getData("acelera")<0?0:this.mario.getData("acelera"))):(this.mario.setData("acelera",this.mario.getData("acelera")+r.MARIO.DECELERACION),this.mario.setData("acelera",this.mario.getData("acelera")>0?0:this.mario.getData("acelera"))),this.mario.setVelocityX(this.mario.getData("acelera"))):this.mario.anims.play("mario-quieto",!0)}gestionar_aceleracion(e){Math.abs(this.mario.getData("acelera"))<r.MARIO.MAX_VEL_SCROLL&&(e?this.mario.setData("acelera",this.mario.getData("acelera")+r.MARIO.ACELERACION):this.mario.setData("acelera",this.mario.getData("acelera")-r.MARIO.ACELERACION))}checkFallOutBounds(e){this.mario.body.bottom>=e&&(console.log(this.mario.body.bottom,this.mario.visible),this.mario.visible&&this.mario.setVisible(!1))}animaciones_mario(){this.relatedScene.anims.create({key:"mario-andar",frames:this.relatedScene.anims.generateFrameNumbers("mario-ss1",{frames:[1,2]}),frameRate:10,yoyo:!0,repeat:-1}),this.relatedScene.anims.create({key:"mario-quieto",frames:[{key:"mario-ss1",frame:0}],frameRate:10})}get(){return this.mario}}class c{constructor(e){this.relatedScene=e}create(e){const{x:t,y:a,origin:s,texto:i,size:r,style:o,fll:l,family:c,strokeColor:n,strokeSize:h,shadowColor:d,bool1:m,bool2:g}=e;console.log(e),this.txt=this.relatedScene.add.text(t,a,i,{fontSize:r+"px",fontStyle:o,fill:l,fontFamily:c}),this.crear_tweens(i),this.txt.setStroke(n,h).setShadow(2,2,d,2,m,g),this.txt.setOrigin(s[0],s[1]),console.log(this.txt)}crear_tweens(e){[" Ouch! "," Fuera de aqui! \n cacho subnormal! "].forEach((t=>{t.slice(0,5)===e.slice(0,5)&&this.relatedScene.tweens.add({targets:this.txt,y:3*this.relatedScene.sys.game.config.height-200,x:this.relatedScene.jugador.get().x,scale:1.2,ease:"easeOut",duration:1500})})),[" DonkeyJon "," Nivel Superado! "," Siguiente Nivel "].forEach((t=>{t===e&&this.relatedScene.tweens.add({targets:this.txt,scale:1.2,x:24,ease:"Ease",yoyo:!0,hold:900,duration:2e3,repeat:-1})}))}centrar(e,t,a){[" DonkeyJon "," Nivel "," Nivel Superado! "," Game Over "," Siguiente Nivel "," Menu Config "].forEach((s=>{e.slice(0,5)===s.slice(0,5)&&this.txt.setX(centrar_txt(this.txt,t*a))}))}get(){return this.txt}}class n{constructor(e,t){this.relatedScene=e,this.direccion=t}create(){const{id:e,x:t,y:a,ang:s,scX:i,scY:r,origin:o}=this.direccion;this.boton=this.relatedScene.add.image(t,a,e).setInteractive(),this.boton.setOrigin(o[0],o[1]).setScale(i,r),this.boton.setAngle(s).setFrame(0).setDepth(50),this.boton.setX(t).setY(a),this.boton.on("pointerover",(()=>{this.boton.setScale(i+.1,r+.1)})),this.boton.on("pointerout",(()=>{this.boton.setScale(i,r)})),this.boton.on("pointerdown",(()=>{this.relatedScene.scale.isFullscreen?this.relatedScene.scale.stopFullscreen():this.relatedScene.scale.startFullscreen()}))}}class h{constructor(e,t){this.relatedScene=e,this.config=t}create(e,t){const{vel:a,ang:s,grav:i,lifeSp:r,cantidad:o,esc:l,autoRun:c,duracion:n}=this.config;this.emisor=this.relatedScene.add.particles(e,t,"brick-particle",{speed:{min:a[0],max:a[1]},angle:{min:s[0],max:s[1]},gravityY:i,lifespan:r,quantity:o,scale:{start:l[0],end:l[1]},on:c}),this.relatedScene.time.delayedCall(n,(()=>this.emisor.stop())),console.log(this.emisor)}update(){}get(){return this.emisor}}class d extends a.Scene{constructor(){super("Game")}init(){this.mario=new l(this),this.botonfullscreen=new n(this,{id:"boton-fullscreen",x:Math.floor(this.sys.game.config.width/1.2),y:-32,ang:0,scX:.5,scY:.5,origin:[0,0]}),this.emisor=new h(this,{vel:[100,200],ang:[0,360],grav:300,lifeSp:900,cantidad:35,esc:[Phaser.Math.FloatBetween(.8,1.8),0],autoRun:!1}),this.marcadorptos=new c(this),this.marcadorhi=new c(this),this.sonido_marioTuberias=this.sound.add("mario-tuberias"),this.sonido_jumpbros=this.sound.add("jumpbros"),this.bricks_fall=this.sound.add("bricks-fall")}preload(){}create(){this.map1=this.make.tilemap({key:"map1"}),this.tileset1=this.map1.addTilesetImage("SuperMarioBros-World1-1","tiles1"),this.layer1=this.map1.createLayer("World1",this.tileset1,r.getLayer1().left*r.screen.TILE_X*r.getLayer1().scaleX,r.getLayer1().top*r.screen.TILE_Y*r.getLayer1().scaleY),this.layer1.setScale(r.getLayer1().scaleX,r.getLayer1().scaleY),this.ajustes_tiles(),this.set_cameras(),this.set_cameras_marcadores(),this.mario.create(),this.set_marcadores_txt(),this.botonfullscreen.create(),this.cameras.main.startFollow(this.mario.get()),this.set_colliders()}update(){this.mario.update()}set_cameras(){this.cameras.main.setBounds(0,0,this.layer1.x+this.layer1.width*r.getLayer1().scaleX,this.layer1.height*r.getLayer1().scaleY),this.physics.world.setBounds(this.sys.game.config.width/16,-100,this.layer1.x+this.layer1.width*r.getLayer1().scaleX-300,this.layer1.height*r.getLayer1().scaleY+150)}set_cameras_marcadores(){const{x:e,y:t,ancho:a,alto:s,scrollX:i,scrollY:o}=r.getCameraScores();this.mapa_scores=this.cameras.add(e,t,this.sys.game.config.width,s).setZoom(1).setName("view-scores").setAlpha(1).setOrigin(0,0),this.mapa_scores.scrollX=i,this.mapa_scores.scrollY=o,console.log(this.mapa_scores)}set_keyControlsCameras(){const e=this.input.keyboard.createCursorKeys(),t={camera:this.cameras.main,left:e.left,right:e.right,speed:.2};this.controls=new Phaser.Cameras.Controls.FixedKeyControl(t)}set_colliders(){this.layer1.setCollisionBetween(14,16),this.layer1.setCollisionBetween(21,22),this.layer1.setCollisionBetween(27,28),this.layer1.setCollision([40]),this.physics.add.collider(this.mario.get(),this.layer1,((e,t)=>{!function(e,t,a){e.body;const s=e.body.blocked.up;if(15===t.index&&s){a.layer1.putTileAt(1,t.x,t.y);const e=t.getCenterX(),s=t.getCenterY();a.emisor.create(e,s),o(a.bricks_fall,!1,.3)}}(e,t,this)}))}ajustes_tiles(){this.layer1.replaceByIndex(11,1),this.layer1.replaceByIndex(12,1),this.layer1.replaceByIndex(18,1)}set_marcadores_txt(){var e;(e=this).marcadorptos.create({x:e.mapa_scores.x+8,y:-40,origin:[0,0],texto:"Puntos: "+e.mario.get().x.toString(),size:32,style:"bold",fll:"#ffa",family:"arial, sans-serif",strokeColor:"#ee9011",strokeSize:8,ShadowColor:"#111111",bool1:!0,bool2:!0}),e.marcadorhi.create({x:e.sys.game.config.width/1.8,y:-40,origin:[.5,0],texto:"Hi: 5000",size:32,style:"bold",fll:"#ffa",family:"arial, sans-serif",strokeColor:"#ee9011",strokeSize:8,ShadowColor:"#111111",bool1:!0,bool2:!0})}}class m extends a.Scene{constructor(){super("GameOver")}create(){this.cameras.main.setBackgroundColor(16711680),this.add.image(512,384,"background").setAlpha(.5),this.add.text(512,384,"Game Over",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}}class g extends a.Scene{constructor(){super("MainMenu")}create(){this.add.image(512,384,"background"),this.add.image(512,300,"logo"),this.add.text(512,460,"Main Menu",{fontFamily:"Arial Black",fontSize:38,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5),this.scene.start("Game")}}class u extends a.Scene{constructor(){super("Preloader")}init(){const e=this.sys.game.config.width,t=this.sys.game.config.height;this.add.image(0,0,"background").setOrigin(0,0),this.txtcargando=new c(this),this.txtcargando.create({x:Math.floor(e/2),y:Math.floor(t/4),origin:[.5,0],texto:" Cargando... ",size:20,style:"",fll:"#ff0",family:"verdana",strokeColor:"#ee9011",strokeSize:4,ShadowColor:"#111111",bool1:!1,bool2:!0}),this.add.rectangle(Math.floor(e/2),Math.floor(t/2),Math.floor(e/1.5),Math.floor(t/12)).setStrokeStyle(1,16772744);const a=this.add.rectangle(Math.floor(e/2)-Math.floor(e/3)+4,Math.floor(t/2),4,Math.floor(t/14),16750865);this.load.on("progress",(t=>{a.width=Math.floor(e/1.55)*t}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.spritesheet("boton-fullscreen","boton-fullscreen.png",{frameWidth:64,frameHeight:64}),this.load.image("brick-particle","particula-ladrillo-mario.png"),this.load.tilemapTiledJSON("map1","mario-level-1-1.json"),this.load.image("tiles1","super_mario.png"),this.load.spritesheet("mario-ss1","mario-ss1.png",{frameWidth:16,frameHeight:16}),this.load.plugin("rexvirtualjoystickplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexvirtualjoystickplugin.min.js",!0),this.load.audio("mario-tuberias","audio/mario-tuberias.mp3"),this.load.audio("jumpbros","audio/jumpbros.ogg"),this.load.audio("fireworks","audio/fireworks.mp3"),this.load.audio("bricks-fall","audio/bricks-fall.mp3")}create(){this.scene.start("MainMenu")}}const y={type:Phaser.AUTO,width:768,height:576,parent:"game-container",backgroundColor:"#121212",pixelArt:!0,physics:{default:"arcade",arcade:{gravity:{y:770},debug:!1}},scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[s,u,g,d,m]};new Phaser.Game(y);
